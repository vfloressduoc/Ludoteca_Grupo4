{% load static %}


<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario</title>

    <!-- *** LIBRERIA DE ESTILOS (6.4.0 RECOMENDADA EN VIDEO DE CLASE *** -->
    <link rel="stylesheet" href="{% static '/css/formularios-style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body>

    <div class="button-container">
        <a href="{%  url 'iniciarsesion' %}"><button>Iniciar Sesión</button></a>
        <a href="{%  url 'home' %}"><button>Volver</button></a>
    </div>

    <div class="container">
        <div class="form-content">

            <h1 id="title">Registro</h1>
            
            <!-- *** FORMULARIO *** -->

            <form id="formulario_registro" action="">

                <div class="input-group">
                
                    <!-- *** LAS OPCIONES *** -->

                    <!--NOMBRE-->
                    <div class="input-field"> 
                        <i class="fa-solid fa-user"></i>
                        <input type="text" placeholder="Nombre" name="Nombre" id="nameInput"> <!-- placeholder es el texto que se encuentra dentro de input, name es el nombre que aparece arriba de la pagina web cuando se invoca y id es el identificador para usar este recurso en el codigo -->
                        <small class='text-danger' id='nameInput-error'></small> <!-- Mensaje de error que se muestra cuando el usuario no ingresa el dato -->
                    </div>

                    <!--AP.PATERNO-->
                    <div class="input-field"> 
                        <i class="fa-solid fa-user"></i>
                        <input type="text" placeholder="Apellido" name="Apellido" id="apInput"> 
                        <small class='text-danger' id='appatInput-error'></small>
                    </div>

                    <!--USERNAME-->
                    <div class="input-field"> 
                        <i class="fa-solid fa-user"></i>
                        <input type="text" placeholder="Usuario" name="username" id="usuarioInput"> 
                        <small class='text-danger' id='usuarioInput-error'></small>
                    </div>

                    <!--CORREO-->
                    <div class="input-field">
                        <i class="fa-solid fa-envelope"></i> 
                        <input type="text" placeholder="Correo" name="Correo" id="correoInput" pattern=".+@.+\..+"> 
                        <small class='text-danger' id='correoInput-error'></small>
                    </div>

                    <!--CLAVE DE INGRESO-->
                    <div class="input-field">
                        <i class="fa-solid fa-lock"></i> 
                        <input type="password" placeholder="Clave: Al menos: 1 numero y 1 mayuscula" name="Clave" id="claveInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,18}">
                        <small class='text-danger' id='claveInput-error'></small> 
                    </div>
                    
                    <!--VERIFICAR CLAVE DE INGRESO-->
                    <div class="input-field">
                        <i class="fa-solid fa-lock"></i> 
                        <input type="password" placeholder="Repite clave: Asegurate de que sea igual" name="VerificadorClave" id="verificaClaveInput" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,18}"> 
                        <small class='text-danger' id='verificaClaveInput-error'></small>
                    </div> 

                    <!--DIRECCION-->
                    <div class="input-field"> 
                        <i class="fa-solid fa-user"></i>
                        <input type="text" placeholder="Direccion de despacho" name="Direccion" id="direccionInput"> 
                        <small class='text-danger' id='direccionInput-error'></small>
                    </div>

                    <!--FECHA DE NACIMIENTO-->
                    <div class="input-field">
                    <i class="fa-solid fa-calendar"></i>
                    <label for="nacimientoInput">Fecha de nacimiento</label>
                    <input type="date" name="Nacimiento" id="nacimientoInput">
                    <small class='text-danger' id='nacimientoInput-error'></small>
                    </div>                                   

                    <!-- <p>Olvidaste tu contraseña?<a href="#">click aqui</a> </p> --> <!-- Mensaje de olvidaste tu contraseña, recurso inutilizado por ahora -->

                </div>       
                
                <!-- *** BOTONES *** -->
                <div class="btn-field">

                    <!--BOTON DE REGISTRO-->
                    <button id="signUp" type="submit">Registro</button> <!-- submit es para que el boton responda-->
                    <!-- BOTON LIMPIAR DATOS-->
                    <button id="limpiar" type="reset">Limpiar</button>
                    <!--BOTON DE INICIO DE SESION-->
                    <!-- <button id="signIn" type="button" class="disable">Login</button> -->
                </div>
            
            </form>
        </div>

    </div>

    

    <!-- *** SCRIPT QUE PERMITE QUE EL FORMULARIO ATRAPE LOS DATOS *** -->
    
    <script src="{% static '/js/01-jq-3.7.1.min.js' %}"></script><!-- Esto llama a la libreria jqwery que usamos, hasta el momento para la restriccion de campos -->

    <script>
        $(document).ready(function(){
            $('#formulario_registro').submit(function(event){
                event.preventDefault(); 

                //Limpia las alertas cuandos se escribe el dato despues de haber arrojado error
                $('#nameInput-error').text('');
                $('#apInput-error').text('');
                $('#usuarioInput-error').text('');
                $('#correoInput-error').text('');
                $('#claveInput-error').text('');
                $('#verificaClaveInput-error').text('');
                $('#nacimientoInput-error').text('');

                //valida los datos y envia las alertas en el cuadro de texto del dato que falta
                if($('#nameInput').val() === ''){
                    $('#nameInput-error').text('Ingresar un nombre es obligatorio');
                    alert('Por favor, ingresa un nombre');
                    return;
                }
        

                if($('#apInput').val() === ''){
                    $('#appatInput-error').text('Ingresar un apellido es obligatorio');
                    alert('Por favor, ingresa un apellido');
                    return;
                }
        
                if($('#usuarioInput').val() === ''){
                    $('#usuarioInput-error').text('Crear un usuario es obligatorio');
                    alert('Por favor, ingresa un nombre de usuario');
                    return;
                }
        
                if($('#correoInput').val() === ''){
                    $('#correoInput-error').text('Ingresar un correo electronico es obligatorio');
                    alert('Por favor, ingresa un correo electronico');
                    return;
                }
        
                if($('#claveInput').val() === ''){
                    $('#claveInput-error').text('La clave de ingreso es obligatoria');
                    alert('Por favor, ingresa una clave de nacimiento');
                    return;
                }
        
                if($('#verificaClaveInput').val() === ''){
                    $('#verificaClaveInput-error').text('Por favor, verifique su clave');
                    alert('Por favor, ingresa la verificacion de clave');
                    return;
                }
        
                if($('#nacimientoInput').val() === ''){
                    $('#nacimientoInput-error').text('La fecha de nacimiento es obligatoria');
                    alert('Por favor, ingresa una fecha de nacimiento');
                    return;
                }
                
                // validacion de que la clave y la confirmacion de la clave son iguales

                const clave = $('#claveInput').val();
                const verificaClave = $('#verificaClaveInput').val();
                if (clave !== verificaClave) {
                    $('#verificaClaveInput-error').text('Las contraseñas no coinciden');
                    alert('Las contraseñas no coinciden');
                return;
                }
                
                // calcular la edad en base a nacimientoInput
                var nacimiento = new Date($('#nacimientoInput').val());
                var hoy = new Date();
                var edad = hoy.getFullYear() - nacimiento.getFullYear();
                var difmes = hoy.getMonth() - nacimiento.getMonth();
                if (difmes < 0 || (difmes === 0 && hoy.getDate() < nacimiento.getDate())) {
                    edad--;
                }

                // revisar si la fecha es menor a 13 
                if (edad < 13) {
                    $('#nacimientoInput-error').text('Debes tener al menos 13 años para poder registrarte.');
                    alert('Debes tener al menos 13 años para poder registrarte.');
                return;
                }
                this.submit();
            });
        })
        
        
</script>

</body>
</html>


</body>
</html>
